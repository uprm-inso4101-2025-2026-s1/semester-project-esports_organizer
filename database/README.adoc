= Firestore Emulator (Local)

== What this is
A minimal, local Firestore emulator setup so the team can run a Firebase-like database without any cloud account.

== Prereqs
- Node.js 18+
- npm

== Install (local to this folder)
From this folder:

----
npm i -D firebase-tools

----

Note: Some guides show "npm i -firebase-tools" — the correct command is the one above using -D for a dev dependency.

== Configure
- Copy `.env.example` to your needs. For the frontend to auto-connect, copy the VITE_* vars into your Vite app's `.env.local` (see example values below).
- If you need a starting point for the frontend Firebase setup, see `database/examples/firebase.js` and copy it into your Vite app at `src/lib/firebase.js`.
- `firebase.json`, `firestore.rules`, and `firestore.indexes.json` are pre-configured for a quick start.

== Run
From this folder:

----
npx firebase emulators:start --only firestore --project local-esports-organizer
----

- Firestore Emulator: http://127.0.0.1:8080
- Emulator UI: http://127.0.0.1:4000

Keep this running in one terminal.

== Hooked up to Vite
In your Vite app (frontend), create a lib file at `src/lib/firebase.js` that initializes Firestore and, when `VITE_USE_EMULATORS=true`, connects to the emulator using the host/port from env vars. See example at `database/examples/firebase.js`. No cloud credentials are required for local dev.

Create your Vite app's `.env.local` like:

----
VITE_USE_EMULATORS=true
VITE_FIREBASE_PROJECT_ID=local-esports-organizer
VITE_FIRESTORE_EMULATOR_HOST=127.0.0.1
VITE_FIRESTORE_EMULATOR_PORT=8080
----

== Windows (cmd.exe) quickstart
From repo root:

----
cd database
npm i -D firebase-tools
npm run emu
----

In a second terminal, inside your Vite app directory (replace the path with yours):

----
cd path\to\your-vite-app
rem Create .env.local with the vars shown above
npm install
npm run dev
----

== Stop
Press Ctrl+C in the emulator terminal.

== Switching Between Emulator and Cloud Firestore

To swap between the local emulator and the production (cloud) Firestore, use the `VITE_USE_EMULATORS` variable in your Vite app's `.env.local` file:

- To use the emulator (local development):
+
----
VITE_USE_EMULATORS=true
VITE_FIREBASE_PROJECT_ID=local-esports-organizer
VITE_FIRESTORE_EMULATOR_HOST=127.0.0.1
VITE_FIRESTORE_EMULATOR_PORT=8080
----

- To use the cloud Firestore (production or staging):
+
----
VITE_USE_EMULATORS=false
VITE_FIREBASE_PROJECT_ID=your-firebase-project-id
# Do not set VITE_FIRESTORE_EMULATOR_HOST or VITE_FIRESTORE_EMULATOR_PORT
----

When `VITE_USE_EMULATORS=false`, the app will connect to the cloud Firestore using your Firebase project credentials. Make sure your Firebase config in your Vite app at `src/lib/firebase.js` is set up with your cloud project’s settings (see `database/examples/firebase.js`).

== Cloud Firestore Setup

1. Create a Firebase project at https://console.firebase.google.com/.
2. In the Firebase console, add a web app and copy the config.
3. Update your Vite app's `src/lib/firebase.js` with the config values. For cloud usage, replace the Firebase config object (usually named `firebaseConfig`) with the values from your Firebase project settings (API key, authDomain, projectId, storageBucket, messagingSenderId, appId, etc.).
   // Example:
   // const firebaseConfig = {
   //   apiKey: "YOUR_API_KEY",
   //   authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
   //   projectId: "YOUR_PROJECT_ID",
   //   storageBucket: "YOUR_PROJECT_ID.appspot.com",
   //   messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
   //   appId: "YOUR_APP_ID"
   // };
4. Set `VITE_FIREBASE_PROJECT_ID` in `.env.local` to your cloud project’s ID.
5. Set `VITE_USE_EMULATORS=false` in `.env.local`.
6. Restart your Vite dev server after changing environment variables.
